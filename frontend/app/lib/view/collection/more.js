// Generated by CoffeeScript 1.12.7
(function() {
  var seeMore;

  seeMore = function(more) {
    return util.isInView(more) && !more.attr('loading');
  };

  $.extend(cf.view.collection.prototype, {
    pagination: function() {
      var more, v;
      if (!this.foot) {
        return;
      }
      if (this.collection.criteria.max >= this.collection.count) {
        this.foot.hide();
        return;
      }
      v = this;
      more = this.foot.addClass('text-xs-center').mk('a', {
        "class": 'btn moreBtn'
      }, (ii('more')) + "...", null, 'click', function(e) {
        var t;
        t = util.ct(e);
        t.attr('loading', true);
        return v.collection.resetFetch('next', null, {
          silent: true,
          success: function(res) {
            t.removeAttr('loading');
            v.data = res.entities;
            v.ctn.removeClass('loadingData');
            v.collection.each(v.addOne, v);
            if (typeof v.afterAddAll === "function") {
              v.afterAddAll();
            }
            if (typeof v.afterAjax === "function") {
              v.afterAjax();
            }
            util.loadPic(v.ctn);
            if (v.collection.criteria.offset + v.max >= v.collection.count) {
              return v.foot.remove();
            }
          }
        });
      });
      this.listenTo(cf.bbEvt, 'scroll', function() {
        if (seeMore(more)) {
          return more.trigger('click');
        }
      });
      return cf.bbEvt.trigger('scroll');
    }
  });

}).call(this);

//# sourceMappingURL=more.js.map
