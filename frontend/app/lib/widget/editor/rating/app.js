// Generated by CoffeeScript 1.12.7
(function() {
  var btn;

  require('./rating.css');

  btn = require('../../btn');

  util.starRating = function(max, v) {
    var ctn, i, j, ref;
    ctn = $("<ul class='rater-star' style='width:" + (max * 30) + "px'/>");
    for (i = j = 0, ref = max - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
      ctn.append("<li class='star' style=\"z-index: " + (max - i) + ";width: " + (100 * (i + 1) / max) + "%\">" + (i + 1) + "</li>");
    }
    if (v) {
      ctn.append("<li class='current' style='width:" + (100 * v / max) + "%'>" + v + "</li>");
    }
    return ctn;
  };

  module.exports = cf.view.rating = btn.extend({
    max: 10,
    cleanAll: true,
    className: 'starBox',
    buildMsg: function(arr) {
      return arr.join('|');
    },
    events: {
      'click .rateable .star': function(e) {
        var t, v;
        t = util.ct(e);
        v = +t.text();
        this.form.model.set(this.name, v);
        this.$('.current').remove();
        return this.ctn.append(this.curStar(v / this.max));
      }
    },
    curStar: function(v) {
      return "<li class='current' style='width:" + (100 * v) + "%'>" + v + "</li>";
    },
    enhanceContent: function() {
      var t;
      this.ctn = util.starRating(this.max, this.v || this.val);
      if (this.rateable) {
        this.ctn.addClass('rateable');
      }
      if (this.name) {
        this.ctn.attr('name', this.name);
      }
      this.$el.append(this.ctn);
      if (this.tip) {
        t = $("<div style='width:" + (30 * this.max) + "px;text-align: center'/>");
        t.append("<span class='pull-left'>" + this.tip.low + "</span>");
        t.append("<span>" + this.tip.middle + "</span>");
        t.append("<span class='pull-right'>" + this.tip.high + "</span>");
        return this.$el.append(t);
      }
    }
  });

}).call(this);

//# sourceMappingURL=app.js.map
