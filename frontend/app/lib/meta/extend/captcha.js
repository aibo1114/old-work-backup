// Generated by CoffeeScript 1.12.7
(function() {
  module.exports = function(name, url) {
    if (name == null) {
      name = '_captcha';
    }
    if (url == null) {
      url = '/a/captcha';
    }
    $.extend(cf.tp, {
      captcha: require('./captcha.jade')
    });
    return meta.common[name] = {
      code: name,
      type: "custom",
      label: ii('captcha'),
      events: {
        'click .changeCaptcha': function(e) {
          url = util.ct(e).attr('url') + '?p=' + location.pathname + '&' + new Date().getTime();
          this.$('.captchaImg').load((function(_this) {
            return function() {
              return _this.model.set('_cap', util.getCookie('_cap'));
            };
          })(this)).attr('src', url);
          return this.model.set('beforeSave', 'captcha');
        }
      },
      content: function() {
        var s;
        s = $(cf.rtp('captcha', {
          name: name,
          url: url
        }));
        this.form._trigger.push({
          trigger: 'click',
          elem: s.find('.changeCaptcha')
        });
        return s;
      },
      valid: {
        required: true
      }
    };
  };

}).call(this);

//# sourceMappingURL=captcha.js.map
