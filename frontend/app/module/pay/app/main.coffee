$.extend window,
    _exv: (name, tag, opt)->
        if _.isString tag
            tag = cf.view[tag]
        cf.view[name] = tag.extend opt
_tag = require '../../../lib/view/_tag'
_tag::cleanAll = true
require '../../../ext/string'
require '../../../lib/extend/jquery'
$.extend cf,
    loadTmpl: (name) ->
        require "./tmpl/#{name}.jade"
    tp:
        opt:
            f: require '../../../lib/tmpl'
            u: {}

    rtp: (tmpl, opt = {}) ->
        if _.isString tmpl
            unless cf.tp[tmpl]
                try
                    cf.tp[tmpl] = cf.loadTmpl(tmpl)
                catch
                    cf.tp[tmpl] = cf.loadLibTmpl(tmpl)
            tmpl = cf.tp[tmpl]
        tmpl $.extend opt, cf.tp.opt
##################################################################################################################################
    

W.util = require('./lib/util')
#getPassport()
#给form表单赋值submit时候调用
# ---
# generated by js2coffee 2.2.0
#$('.box-coverbox-list-a').on 'click', (e) ->
#    webgame_id = $(this).attr('data-id')
#    $('#g-select-btn').text $(this).text()
#    $('#g-select-btn').attr 'data-id', webgame_id
#    $.ajax
#        url: 'http://pay1.wan.liebao.cn/index.php/webgame/getServerInfo/'
#        data: webgame_id: webgame_id
#        dataType: 'json'
#        cache: false
#        success: (json) ->
#            if json.code == 1
#                console.log json
#            return
#    return
#提交游戏检测是否存在角色

#关闭弹窗
#点击关闭按钮
#initEvent = ->
#userdata=''

#return userdata
#console.log(userdata)


_app = Backbone.Router.extend
    ctn: '.main'
    initialize: ->
        util.initSelectEvent()
        require('./lib/playHistory')()
        @layout()
        for it in @func
            for k, v of it.routes
                @[v] = it[v]
                @route k, v, it[v]
        window.app = @
        Backbone.history.start()

    layout: ->
        $('#nav').html cf.rtp 'leftMenu',
            items: [
                label: '网上银行(支付宝)'
                href: '#zfb'

            ,
                label: '网上银行(易宝)'
                href: '#yb'
            ]
        $('#nav li').on 'click', ->
            $(this).addClass('nav-li-a-select').siblings().removeClass 'nav-li-a-select'
        require('./lib/setPlayHistory')()
    func: [
        require './func/zfbYb'
    ]
    
    
        #获取玩过的游戏及区服
        #getPassport()

    

#                    @ctn.mk 'strong', null, 'hahah', 'prepend'
#            parent: @ctn
#            setContent: ->
#                @ctn.mk 'a', act: 'act', 'haha'
#$('#paybtn').on click
new _app()