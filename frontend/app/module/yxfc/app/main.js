// Generated by CoffeeScript 1.12.7
(function() {
  var marked, md5;

  require('./style/main.css');

  marked = require('../../../res/js/marked/lib/marked');

  md5 = require('../../../res/js/md5');

  cf.rsPre = cf.actPre = 'http://gmarketing.kisops.com/gmarketing/1/api/';

  $.extend(cf, {
    loadTmpl: function(name) {
      try {
        return require("./tmpl/" + name + ".jade");
      } catch (error) {
        return require("../../console/tmpl/" + name + ".jade");
      }
    },
    loadLibTmpl: function(name) {
      return require("../../../lib/tmpl/" + name + ".jade");
    },
    _init: function() {
      Backbone.Model.setPost();
      cf.id = 'id';
      Backbone.Model.prototype.idAttribute = cf.id;
      cf.community = {
        name: '游戏分成数据',
        resPath: '/'
      };
      require("./meta/meta");
      m.user.loginUrl = util.actUrl('login');
      cf.view.table.prototype.noLastTime = true;
      return m.user.prop = [
        _ep('username', {
          code: 'name'
        }), {
          code: 'pass',
          type: 'password',
          label: '密码',
          valid: {
            required: true
          },
          cvt: function(v) {
            return md5(v);
          }
        }
      ];
    },
    _rOpt: {
      checkSvrAuth: util.restUrl('logincheck'),
      dfPath: 'terms',
      routes: {
        '': 'index',
        '!/loading': 'loading',
        '!/login': 'login',
        '!/terms': 'terms',
        '!/*path': 'dAct'
      },
      terms: function() {
        return $.get('term.md', (function(_this) {
          return function(res) {
            if (res) {
              cf.loadJS(cf.rPath + 'js/');
            }
            return _this.ctn.empty().mk('div', {
              "class": 'article container well'
            }, marked(res));
          };
        })(this));
      }
    },
    _uOpt: {
      onlineCheck: function() {
        cf.noReply = true;
        return $.get(app.checkSvrAuth).done(function(res) {
          if (res.ret === 1) {
            return user.auth(res.user ? res.user : res);
          } else {
            location.hash = util.navUrl(app.logoutPath);
            return app.start();
          }
        });
      },
      afterLogin: function() {
        return new cf.view.consoleMenu({
          home: {
            key: 'terms',
            icon: 'th',
            label: '处罚条款'
          }
        });
      }
    }
  });

  require("../../../lib/ccRouter")();

}).call(this);

//# sourceMappingURL=main.js.map
